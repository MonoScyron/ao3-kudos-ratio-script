// ==UserScript==
// @name                AO3 Comments Dropdown
// @namespace           https://github.com/MonoScyron/ao3-scripts
// @version             0.0.5
// @description         Dropdown button for random nice comments.
// @author              MonoScyron
// @updateURL           https://raw.githubusercontent.com/MonoScyron/ao3-scripts/main/dist/ao3-comments-dropdown.js
// @downloadURL         https://raw.githubusercontent.com/MonoScyron/ao3-scripts/main/dist/ao3-comments-dropdown.js
// @match               https://archiveofourown.org/works/*
// @match               https://archiveofourown.org/chapters/*
// @icon                https://archiveofourown.org/images/ao3_logos/logo_42.png
// @resource cJSON      https://raw.githubusercontent.com/MonoScyron/ao3-scripts/main/json/comments.json
// @grant               GM_getResourceText
// @noframes
// ==/UserScript==
(()=>{var t={451:t=>{var e=function(){var t=function(t,s,i){this.errors=[],void 0===i.raw&&(this.errors.push("Empty input for node"),i.raw=""),t instanceof e.Grammar?(this.grammar=t,this.parent=null,this.depth=0,this.childIndex=0):(this.grammar=t.grammar,this.parent=t,this.depth=t.depth+1,this.childIndex=s),this.raw=i.raw,this.type=i.type,this.isExpanded=!1,this.grammar||this.errors.push("No grammar specified for this node "+this)};function s(t,e){this.node=t;var s=e.split(":");this.target=s[0],1===s.length?this.type=2:(this.rule=s[1],"POP"===this.rule?this.type=1:this.type=0)}function i(t,e){this.raw=e,this.grammar=t,this.falloff=1,Array.isArray(e)?this.defaultRules=e:("string"==typeof e||e instanceof String)&&(this.defaultRules=[e])}t.prototype.toString=function(){return"Node('"+this.raw+"' "+this.type+" d:"+this.depth+")"},t.prototype.expandChildren=function(s,i){if(this.children=[],this.finishedText="",this.childRule=s,void 0!==this.childRule){var r=e.parse(s);r.errors.length>0&&(this.errors=this.errors.concat(r.errors));for(var n=0;n<r.length;n++)this.children[n]=new t(this,n,r[n]),i||this.children[n].expand(i),this.finishedText+=this.children[n].finishedText}else this.errors.push("No child rule provided, can't expand children")},t.prototype.expand=function(t){if(!this.isExpanded)switch(this.isExpanded=!0,this.expansionErrors=[],this.type){case-1:this.expandChildren(this.raw,t);break;case 0:this.finishedText=this.raw;break;case 1:this.preactions=[],this.postactions=[];var i=e.parseTag(this.raw);this.symbol=i.symbol,this.modifiers=i.modifiers;for(var r=0;r<i.preactions.length;r++)this.preactions[r]=new s(this,i.preactions[r].raw);for(r=0;r<i.postactions.length;r++);for(r=0;r<this.preactions.length;r++)0===this.preactions[r].type&&this.postactions.push(this.preactions[r].createUndo());for(r=0;r<this.preactions.length;r++)this.preactions[r].activate();this.finishedText=this.raw;var n=this.grammar.selectRule(this.symbol,this,this.errors);for(this.expandChildren(n,t),r=0;r<this.modifiers.length;r++){var a=this.modifiers[r],o=[];if(a.indexOf("(")>0){var h=/\(([^)]+)\)/.exec(this.modifiers[r]);!h||h.length<2||(o=h[1].split(","),a=this.modifiers[r].substring(0,a.indexOf("(")))}var l=this.grammar.modifiers[a];l?this.finishedText=l(this.finishedText,o):(this.errors.push("Missing modifier "+a),this.finishedText+="((."+a+"))")}for(r=0;r<this.postactions.length;r++)this.postactions[r].activate();break;case 2:this.action=new s(this,this.raw),this.action.activate(),this.finishedText=""}},t.prototype.clearEscapeChars=function(){this.finishedText=this.finishedText.replace(/\\\\/g,"DOUBLEBACKSLASH").replace(/\\/g,"").replace(/DOUBLEBACKSLASH/g,"\\")},s.prototype.createUndo=function(){return 0===this.type?new s(this.node,this.target+":POP"):null},s.prototype.activate=function(){var e=this.node.grammar;switch(this.type){case 0:this.ruleSections=this.rule.split(","),this.finishedRules=[],this.ruleNodes=[];for(var s=0;s<this.ruleSections.length;s++){var i=new t(e,0,{type:-1,raw:this.ruleSections[s]});i.expand(),this.finishedRules.push(i.finishedText)}e.pushRules(this.target,this.finishedRules,this);break;case 1:e.popRules(this.target);break;case 2:e.flatten(this.target,!0)}},s.prototype.toText=function(){switch(this.type){case 0:return this.target+":"+this.rule;case 1:return this.target+":POP";case 2:return"((some function))";default:return"((Unknown Action))"}},i.prototype.selectRule=function(t){if(this.conditionalRule){var e=this.grammar.expand(this.conditionalRule,!0);if(this.conditionalValues[e]&&null!=(i=this.conditionalValues[e].selectRule(t)))return i}if(this.ranking)for(var s=0;s<this.ranking.length;s++){var i;if(null!=(i=this.ranking.selectRule()))return i}if(void 0!==this.defaultRules){var r=0,n=this.distribution;switch(n||(n=this.grammar.distribution),n){case"shuffle":this.shuffledDeck&&0!==this.shuffledDeck.length||(this.shuffledDeck=function(t,e){for(var s,i,r=t.length;0!==r;)i=Math.floor(Math.random()*r),s=t[r-=1],t[r]=t[i],t[i]=s;return t}(Array.apply(null,{length:this.defaultRules.length}).map(Number.call,Number),this.falloff)),r=this.shuffledDeck.pop();break;case"weighted":t.push("Weighted distribution not yet implemented");break;case"falloff":t.push("Falloff distribution not yet implemented");break;default:r=Math.floor(Math.pow(Math.random(),this.falloff)*this.defaultRules.length)}return this.defaultUses||(this.defaultUses=[]),this.defaultUses[r]=++this.defaultUses[r]||1,this.defaultRules[r]}return t.push("No default rules defined for "+this),null},i.prototype.clearState=function(){this.defaultUses&&(this.defaultUses=[])};var r=function(t,e,s){this.key=e,this.grammar=t,this.rawRules=s,this.baseRules=new i(this.grammar,s),this.clearState()};r.prototype.clearState=function(){this.stack=[this.baseRules],this.uses=[],this.baseRules.clearState()},r.prototype.pushRules=function(t){var e=new i(this.grammar,t);this.stack.push(e)},r.prototype.popRules=function(){this.stack.pop()},r.prototype.selectRule=function(t,e){return this.uses.push({node:t}),0===this.stack.length?(e.push("The rule stack for '"+this.key+"' is empty, too many pops?"),"(("+this.key+"))"):this.stack[this.stack.length-1].selectRule()},r.prototype.getActiveRules=function(){return 0===this.stack.length?null:this.stack[this.stack.length-1].selectRule()},r.prototype.rulesToJSON=function(){return JSON.stringify(this.rawRules)};var n=function(t,e){this.modifiers={},this.loadFromRawObj(t)};function a(t){var e=t.toLowerCase();return"a"===e||"e"===e||"i"===e||"o"===e||"u"===e}n.prototype.clearState=function(){for(var t=Object.keys(this.symbols),e=0;e<t.length;e++)this.symbols[t[e]].clearState()},n.prototype.addModifiers=function(t){for(var e in t)t.hasOwnProperty(e)&&(this.modifiers[e]=t[e])},n.prototype.loadFromRawObj=function(t){if(this.raw=t,this.symbols={},this.subgrammars=[],this.raw)for(var e in this.raw)this.raw.hasOwnProperty(e)&&(this.symbols[e]=new r(this,e,this.raw[e]))},n.prototype.createRoot=function(e){return new t(this,0,{type:-1,raw:e})},n.prototype.expand=function(t,e){var s=this.createRoot(t);return s.expand(),e||s.clearEscapeChars(),s},n.prototype.flatten=function(t,e){return this.expand(t,e).finishedText},n.prototype.toJSON=function(){for(var t=Object.keys(this.symbols),e=[],s=0;s<t.length;s++){var i=t[s];e.push(' "'+i+'" : '+this.symbols[i].rulesToJSON())}return"{\n"+e.join(",\n")+"\n}"},n.prototype.pushRules=function(t,e,s){void 0===this.symbols[t]?(this.symbols[t]=new r(this,t,e),s&&(this.symbols[t].isDynamic=!0)):this.symbols[t].pushRules(e)},n.prototype.popRules=function(t){this.symbols[t]||this.errors.push("Can't pop: no symbol for key "+t),this.symbols[t].popRules()},n.prototype.selectRule=function(t,e,s){if(this.symbols[t])return this.symbols[t].selectRule(e,s);for(var i=0;i<this.subgrammars.length;i++)if(this.subgrammars[i].symbols[t])return this.subgrammars[i].symbols[t].selectRule();return s.push("No symbol for '"+t+"'"),"(("+t+"))"};var o={replace:function(t,e){return t.replace(new RegExp(e[0].replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1"),"g"),e[1])},capitalizeAll:function(t){for(var e,s="",i=!0,r=0;r<t.length;r++)(e=t.charAt(r))>="a"&&e<="z"||e>="A"&&e<="Z"||e>="0"&&e<="9"?i?(s+=t.charAt(r).toUpperCase(),i=!1):s+=t.charAt(r):(i=!0,s+=t.charAt(r));return s},capitalize:function(t){return t.charAt(0).toUpperCase()+t.substring(1)},a:function(t){if(t.length>0){if("u"===t.charAt(0).toLowerCase()&&t.length>2&&"i"===t.charAt(2).toLowerCase())return"a "+t;if(a(t.charAt(0)))return"an "+t}return"a "+t},firstS:function(t){console.log(t);var e=t.split(" "),s=o.s(e[0])+" "+e.slice(1).join(" ");return console.log(s),s},s:function(t){switch(t.charAt(t.length-1)){case"s":case"h":case"x":return t+"es";case"y":return a(t.charAt(t.length-2))?t+"s":t.substring(0,t.length-1)+"ies";default:return t+"s"}},ed:function(t){switch(t.charAt(t.length-1)){case"s":case"h":case"x":default:return t+"ed";case"e":return t+"d";case"y":return a(t.charAt(t.length-2))?t+"d":t.substring(0,t.length-1)+"ied"}}};return(e={createGrammar:function(t){return new n(t)},parseTag:function(t){for(var s={symbol:void 0,preactions:[],postactions:[],modifiers:[]},i=e.parse(t),r=void 0,n=0;n<i.length;n++)if(0===i[n].type){if(void 0!==r)throw"multiple main sections in "+t;r=i[n].raw}else s.preactions.push(i[n]);if(void 0===r);else{var a=r.split(".");s.symbol=a[0],s.modifiers=a.slice(1)}return s},parse:function(t){var e=0,s=!1,i=[],r=!1,n=[],a=0,o="",h=void 0;if(null===t)return(i=[]).errors=n,i;function l(e,s,r){var a;s-e<1&&(1===r&&n.push(e+": empty tag"),2===r&&n.push(e+": empty action")),a=void 0!==h?o+"\\"+t.substring(h+1,s):t.substring(e,s),i.push({type:r,raw:a}),h=void 0,o=""}for(var u=0;u<t.length;u++)if(r)r=!1;else switch(t.charAt(u)){case"[":0!==e||s||(a<u&&l(a,u,0),a=u+1),e++;break;case"]":0!=--e||s||(l(a,u,2),a=u+1);break;case"#":0===e&&(s?(l(a,u,1),a=u+1):(a<u&&l(a,u,0),a=u+1),s=!s);break;case"\\":r=!0,o+=t.substring(a,u),a=u+1,h=u}return a<t.length&&l(a,t.length,0),s&&n.push("Unclosed tag"),e>0&&n.push("Too many ["),e<0&&n.push("Too many ]"),(i=i.filter((function(t){return 0!==t.type||0!==t.raw.length}))).errors=n,i}}).baseEngModifiers=o,e.TraceryNode=t,e.Grammar=n,e.Symbol=r,e.RuleSet=i,e}();t.exports=e}},e={};function s(i){var r=e[i];if(void 0!==r)return r.exports;var n=e[i]={exports:{}};return t[i](n,n.exports,s),n.exports}(()=>{"use strict";!function(){let t=s(451),e=t.createGrammar(JSON.parse(GM_getResourceText("cJSON")));e.addModifiers(t.baseEngModifiers);let i=document.createElement("p");i.innerHTML='\n    <p class="footnote" style="margin-bottom: -15px;">\n        <select name="nice-comment" id="nice-comment-dropdown">\n            <option selected="selected" value="clear"></option>\n            <option value="re_read">Re-read</option>\n            <option value="love">Love</option>\n        </select>\n    </p>\n    ',i=i.firstElementChild;let r=i.firstElementChild;const n=document.querySelector("textarea[id*='comment_content_for']");r.addEventListener("change",(()=>n.value=e.flatten(`#${r.value}#`).replace("  "," ")));let a=document.querySelector("form.new_comment fieldset");a.insertBefore(i,a.children[3])}()})()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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MUksU0FBUyxHQUN2RCxDQXRCRCxFIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vbm9kZV9tb2R1bGVzL3RyYWNlcnktZ3JhbW1hci90cmFjZXJ5LmpzIiwid2VicGFjazovLy93ZWJwYWNrL2Jvb3RzdHJhcCIsIndlYnBhY2s6Ly8vLi9zcmMvYW8zLWNvbW1lbnRzLWRyb3Bkb3duLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogQGF1dGhvciBLYXRlXG4gKi9cblxudmFyIHRyYWNlcnkgPSBmdW5jdGlvbigpIHtcblxuICAgIHZhciBUcmFjZXJ5Tm9kZSA9IGZ1bmN0aW9uKHBhcmVudCwgY2hpbGRJbmRleCwgc2V0dGluZ3MpIHtcbiAgICAgICAgdGhpcy5lcnJvcnMgPSBbXTtcblxuICAgICAgICAvLyBObyBpbnB1dD8gQWRkIGFuIGVycm9yLCBidXQgY29udGludWUgYW55d2F5c1xuICAgICAgICBpZiAoc2V0dGluZ3MucmF3ID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHRoaXMuZXJyb3JzLnB1c2goXCJFbXB0eSBpbnB1dCBmb3Igbm9kZVwiKTtcbiAgICAgICAgICAgIHNldHRpbmdzLnJhdyA9IFwiXCI7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBJZiB0aGUgcm9vdCBub2RlIG9mIGFuIGV4cGFuc2lvbiwgaXQgd2lsbCBoYXZlIHRoZSBncmFtbWFyIHBhc3NlZCBhcyB0aGUgJ3BhcmVudCdcbiAgICAgICAgLy8gIHNldCB0aGUgZ3JhbW1hciBmcm9tIHRoZSAncGFyZW50JywgYW5kIHNldCBhbGwgb3RoZXIgdmFsdWVzIGZvciBhIHJvb3Qgbm9kZVxuICAgICAgICBpZiAoIHBhcmVudCBpbnN0YW5jZW9mIHRyYWNlcnkuR3JhbW1hcikge1xuICAgICAgICAgICAgdGhpcy5ncmFtbWFyID0gcGFyZW50O1xuICAgICAgICAgICAgdGhpcy5wYXJlbnQgPSBudWxsO1xuICAgICAgICAgICAgdGhpcy5kZXB0aCA9IDA7XG4gICAgICAgICAgICB0aGlzLmNoaWxkSW5kZXggPSAwO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5ncmFtbWFyID0gcGFyZW50LmdyYW1tYXI7XG4gICAgICAgICAgICB0aGlzLnBhcmVudCA9IHBhcmVudDtcbiAgICAgICAgICAgIHRoaXMuZGVwdGggPSBwYXJlbnQuZGVwdGggKyAxO1xuICAgICAgICAgICAgdGhpcy5jaGlsZEluZGV4ID0gY2hpbGRJbmRleDtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMucmF3ID0gc2V0dGluZ3MucmF3O1xuICAgICAgICB0aGlzLnR5cGUgPSBzZXR0aW5ncy50eXBlO1xuICAgICAgICB0aGlzLmlzRXhwYW5kZWQgPSBmYWxzZTtcblxuICAgICAgICBpZiAoIXRoaXMuZ3JhbW1hcikge1xuICAgICAgICAgICAgdGhpcy5lcnJvcnMucHVzaChcIk5vIGdyYW1tYXIgc3BlY2lmaWVkIGZvciB0aGlzIG5vZGUgXCIgKyB0aGlzKTtcbiAgICAgICAgfVxuXG4gICAgfTtcblxuICAgIFRyYWNlcnlOb2RlLnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gXCJOb2RlKCdcIiArIHRoaXMucmF3ICsgXCInIFwiICsgdGhpcy50eXBlICsgXCIgZDpcIiArIHRoaXMuZGVwdGggKyBcIilcIjtcbiAgICB9O1xuXG4gICAgLy8gRXhwYW5kIHRoZSBub2RlICh3aXRoIHRoZSBnaXZlbiBjaGlsZCBydWxlKVxuICAgIC8vICBNYWtlIGNoaWxkcmVuIGlmIHRoZSBub2RlIGhhcyBhbnlcbiAgICBUcmFjZXJ5Tm9kZS5wcm90b3R5cGUuZXhwYW5kQ2hpbGRyZW4gPSBmdW5jdGlvbihjaGlsZFJ1bGUsIHByZXZlbnRSZWN1cnNpb24pIHtcbiAgICAgICAgdGhpcy5jaGlsZHJlbiA9IFtdO1xuICAgICAgICB0aGlzLmZpbmlzaGVkVGV4dCA9IFwiXCI7XG5cbiAgICAgICAgLy8gU2V0IHRoZSBydWxlIGZvciBtYWtpbmcgY2hpbGRyZW4sXG4gICAgICAgIC8vIGFuZCBleHBhbmQgaXQgaW50byBzZWN0aW9uXG4gICAgICAgIHRoaXMuY2hpbGRSdWxlID0gY2hpbGRSdWxlO1xuICAgICAgICBpZiAodGhpcy5jaGlsZFJ1bGUgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgdmFyIHNlY3Rpb25zID0gdHJhY2VyeS5wYXJzZShjaGlsZFJ1bGUpO1xuXG4gICAgICAgICAgICAvLyBBZGQgZXJyb3JzIHRvIHRoaXNcbiAgICAgICAgICAgIGlmIChzZWN0aW9ucy5lcnJvcnMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIHRoaXMuZXJyb3JzID0gdGhpcy5lcnJvcnMuY29uY2F0KHNlY3Rpb25zLmVycm9ycyk7XG5cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzZWN0aW9ucy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIHRoaXMuY2hpbGRyZW5baV0gPSBuZXcgVHJhY2VyeU5vZGUodGhpcywgaSwgc2VjdGlvbnNbaV0pO1xuICAgICAgICAgICAgICAgIGlmICghcHJldmVudFJlY3Vyc2lvbilcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jaGlsZHJlbltpXS5leHBhbmQocHJldmVudFJlY3Vyc2lvbik7XG5cbiAgICAgICAgICAgICAgICAvLyBBZGQgaW4gdGhlIGZpbmlzaGVkIHRleHRcbiAgICAgICAgICAgICAgICB0aGlzLmZpbmlzaGVkVGV4dCArPSB0aGlzLmNoaWxkcmVuW2ldLmZpbmlzaGVkVGV4dDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIC8vIEluIG5vcm1hbCBvcGVyYXRpb24sIHRoaXMgc2hvdWxkbid0IGV2ZXIgaGFwcGVuXG4gICAgICAgICAgICB0aGlzLmVycm9ycy5wdXNoKFwiTm8gY2hpbGQgcnVsZSBwcm92aWRlZCwgY2FuJ3QgZXhwYW5kIGNoaWxkcmVuXCIpO1xuICAgICAgICB9XG4gICAgfTtcblxuICAgIC8vIEV4cGFuZCB0aGlzIHJ1bGUgKHBvc3NpYmx5IGNyZWF0aW5nIGNoaWxkcmVuKVxuICAgIFRyYWNlcnlOb2RlLnByb3RvdHlwZS5leHBhbmQgPSBmdW5jdGlvbihwcmV2ZW50UmVjdXJzaW9uKSB7XG5cbiAgICAgICAgaWYgKCF0aGlzLmlzRXhwYW5kZWQpIHtcbiAgICAgICAgICAgIHRoaXMuaXNFeHBhbmRlZCA9IHRydWU7XG5cbiAgICAgICAgICAgIHRoaXMuZXhwYW5zaW9uRXJyb3JzID0gW107XG5cbiAgICAgICAgICAgIC8vIFR5cGVzIG9mIG5vZGVzXG4gICAgICAgICAgICAvLyAtMTogcmF3LCBuZWVkcyBwYXJzaW5nXG4gICAgICAgICAgICAvLyAgMDogUGxhaW50ZXh0XG4gICAgICAgICAgICAvLyAgMTogVGFnIChcIiNzeW1ib2wubW9kLm1vZDIubW9kMyNcIiBvciBcIiNbcHVzaFRhcmdldDpwdXNoUnVsZV1zeW1ib2wubW9kXCIpXG4gICAgICAgICAgICAvLyAgMjogQWN0aW9uIChcIltwdXNoVGFyZ2V0OnB1c2hSdWxlXSwgW3B1c2hUYXJnZXQ6UE9QXVwiLCBtb3JlIGluIHRoZSBmdXR1cmUpXG5cbiAgICAgICAgICAgIHN3aXRjaCh0aGlzLnR5cGUpIHtcbiAgICAgICAgICAgIC8vIFJhdyBydWxlXG4gICAgICAgICAgICBjYXNlIC0xOlxuXG4gICAgICAgICAgICAgICAgdGhpcy5leHBhbmRDaGlsZHJlbih0aGlzLnJhdywgcHJldmVudFJlY3Vyc2lvbik7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgIC8vIHBsYWludGV4dCwgZG8gbm90aGluZyBidXQgY29weSB0ZXh0IGludG8gZmluc2loZWQgdGV4dFxuICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgIHRoaXMuZmluaXNoZWRUZXh0ID0gdGhpcy5yYXc7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgIC8vIFRhZ1xuICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgIC8vIFBhcnNlIHRvIGZpbmQgYW55IGFjdGlvbnMsIGFuZCBmaWd1cmUgb3V0IHdoYXQgdGhlIHN5bWJvbCBpc1xuICAgICAgICAgICAgICAgIHRoaXMucHJlYWN0aW9ucyA9IFtdO1xuICAgICAgICAgICAgICAgIHRoaXMucG9zdGFjdGlvbnMgPSBbXTtcblxuICAgICAgICAgICAgICAgIHZhciBwYXJzZWQgPSB0cmFjZXJ5LnBhcnNlVGFnKHRoaXMucmF3KTtcblxuICAgICAgICAgICAgICAgIC8vIEJyZWFrIGludG8gc3ltYm9sIGFjdGlvbnMgYW5kIG1vZGlmaWVyc1xuICAgICAgICAgICAgICAgIHRoaXMuc3ltYm9sID0gcGFyc2VkLnN5bWJvbDtcbiAgICAgICAgICAgICAgICB0aGlzLm1vZGlmaWVycyA9IHBhcnNlZC5tb2RpZmllcnM7XG5cbiAgICAgICAgICAgICAgICAvLyBDcmVhdGUgYWxsIHRoZSBwcmVhY3Rpb25zIGZyb20gdGhlIHJhdyBzeW50YXhcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHBhcnNlZC5wcmVhY3Rpb25zLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucHJlYWN0aW9uc1tpXSA9IG5ldyBOb2RlQWN0aW9uKHRoaXMsIHBhcnNlZC5wcmVhY3Rpb25zW2ldLnJhdyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcGFyc2VkLnBvc3RhY3Rpb25zLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vICAgdGhpcy5wb3N0YWN0aW9uc1tpXSA9IG5ldyBOb2RlQWN0aW9uKHRoaXMsIHBhcnNlZC5wb3N0YWN0aW9uc1tpXS5yYXcpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vIE1ha2UgdW5kbyBhY3Rpb25zIGZvciBhbGwgcHJlYWN0aW9ucyAocG9wcyBmb3IgZWFjaCBwdXNoKVxuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5wcmVhY3Rpb25zLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLnByZWFjdGlvbnNbaV0udHlwZSA9PT0gMClcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucG9zdGFjdGlvbnMucHVzaCh0aGlzLnByZWFjdGlvbnNbaV0uY3JlYXRlVW5kbygpKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvLyBBY3RpdmF0ZSBhbGwgdGhlIHByZWFjdGlvbnNcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMucHJlYWN0aW9ucy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnByZWFjdGlvbnNbaV0uYWN0aXZhdGUoKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB0aGlzLmZpbmlzaGVkVGV4dCA9IHRoaXMucmF3O1xuXG4gICAgICAgICAgICAgICAgLy8gRXhwYW5kIChwYXNzaW5nIHRoZSBub2RlLCB0aGlzIGFsbG93cyB0cmFja2luZyBvZiByZWN1cnNpb24gZGVwdGgpXG5cbiAgICAgICAgICAgICAgICB2YXIgc2VsZWN0ZWRSdWxlID0gdGhpcy5ncmFtbWFyLnNlbGVjdFJ1bGUodGhpcy5zeW1ib2wsIHRoaXMsIHRoaXMuZXJyb3JzKTtcblxuICAgICAgICAgICAgICAgIHRoaXMuZXhwYW5kQ2hpbGRyZW4oc2VsZWN0ZWRSdWxlLCBwcmV2ZW50UmVjdXJzaW9uKTtcblxuICAgICAgICAgICAgICAgIC8vIEFwcGx5IG1vZGlmaWVyc1xuICAgICAgICAgICAgICAgIC8vIFRPRE86IFVwZGF0ZSBwYXJzZSBmdW5jdGlvbiB0byBub3QgdHJpZ2dlciBvbiBoYXNodGFncyB3aXRoaW4gcGFyZW50aGVzaXMgd2l0aGluIHRhZ3MsXG4gICAgICAgICAgICAgICAgLy8gICBzbyB0aGF0IG1vZGlmaWVyIHBhcmFtZXRlcnMgY2FuIGNvbnRhaW4gdGFncyBcIiNzdG9yeS5yZXBsYWNlKCNwcm90YWdvbmlzdCMsICNuZXdDaGFyYWN0ZXIjKSNcIlxuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5tb2RpZmllcnMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG1vZE5hbWUgPSB0aGlzLm1vZGlmaWVyc1tpXTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG1vZFBhcmFtcyA9IFtdO1xuICAgICAgICAgICAgICAgICAgICBpZiAobW9kTmFtZS5pbmRleE9mKFwiKFwiKSA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZWdFeHAgPSAvXFwoKFteKV0rKVxcKS87XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRvZG86IGlnbm9yZSBhbnkgZXNjYXBlZCBjb21tYXMuICBGb3Igbm93LCBjb21tYXMgYWx3YXlzIHNwbGl0XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVzdWx0cyA9IHJlZ0V4cC5leGVjKHRoaXMubW9kaWZpZXJzW2ldKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghcmVzdWx0cyB8fCByZXN1bHRzLmxlbmd0aCA8IDIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG1vZFBhcmFtcyA9IHJlc3VsdHNbMV0uc3BsaXQoXCIsXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1vZE5hbWUgPSB0aGlzLm1vZGlmaWVyc1tpXS5zdWJzdHJpbmcoMCwgbW9kTmFtZS5pbmRleE9mKFwiKFwiKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIHZhciBtb2QgPSB0aGlzLmdyYW1tYXIubW9kaWZpZXJzW21vZE5hbWVdO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIE1pc3NpbmcgbW9kaWZpZXI/XG4gICAgICAgICAgICAgICAgICAgIGlmICghbW9kKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmVycm9ycy5wdXNoKFwiTWlzc2luZyBtb2RpZmllciBcIiArIG1vZE5hbWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5maW5pc2hlZFRleHQgKz0gXCIoKC5cIiArIG1vZE5hbWUgKyBcIikpXCI7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmZpbmlzaGVkVGV4dCA9IG1vZCh0aGlzLmZpbmlzaGVkVGV4dCwgbW9kUGFyYW1zKTtcblxuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvLyBQZXJmb3JtIHBvc3QtYWN0aW9uc1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5wb3N0YWN0aW9ucy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBvc3RhY3Rpb25zW2ldLmFjdGl2YXRlKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAyOlxuXG4gICAgICAgICAgICAgICAgLy8gSnVzdCBhIGJhcmUgYWN0aW9uPyAgRXhwYW5kIGl0IVxuICAgICAgICAgICAgICAgIHRoaXMuYWN0aW9uID0gbmV3IE5vZGVBY3Rpb24odGhpcywgdGhpcy5yYXcpO1xuICAgICAgICAgICAgICAgIHRoaXMuYWN0aW9uLmFjdGl2YXRlKCk7XG5cbiAgICAgICAgICAgICAgICAvLyBObyB2aXNpYmxlIHRleHQgZm9yIGFuIGFjdGlvblxuICAgICAgICAgICAgICAgIC8vIFRPRE86IHNvbWUgdmlzaWJsZSB0ZXh0IGZvciBpZiB0aGVyZSBpcyBhIGZhaWx1cmUgdG8gcGVyZm9ybSB0aGUgYWN0aW9uP1xuICAgICAgICAgICAgICAgIHRoaXMuZmluaXNoZWRUZXh0ID0gXCJcIjtcbiAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgfVxuXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAvL2NvbnNvbGUud2FybihcIkFscmVhZHkgZXhwYW5kZWQgXCIgKyB0aGlzKTtcbiAgICAgICAgfVxuXG4gICAgfTtcblxuICAgIFRyYWNlcnlOb2RlLnByb3RvdHlwZS5jbGVhckVzY2FwZUNoYXJzID0gZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgdGhpcy5maW5pc2hlZFRleHQgPSB0aGlzLmZpbmlzaGVkVGV4dC5yZXBsYWNlKC9cXFxcXFxcXC9nLCBcIkRPVUJMRUJBQ0tTTEFTSFwiKS5yZXBsYWNlKC9cXFxcL2csIFwiXCIpLnJlcGxhY2UoL0RPVUJMRUJBQ0tTTEFTSC9nLCBcIlxcXFxcIik7XG4gICAgfTtcblxuICAgIC8vIEFuIGFjdGlvbiB0aGF0IG9jY3VycyB3aGVuIGEgbm9kZSBpcyBleHBhbmRlZFxuICAgIC8vIFR5cGVzIG9mIGFjdGlvbnM6XG4gICAgLy8gMCBQdXNoOiBba2V5OnJ1bGVdXG4gICAgLy8gMSBQb3A6IFtrZXk6UE9QXVxuICAgIC8vIDIgZnVuY3Rpb246IFtmdW5jdGlvbk5hbWUocGFyYW0wLHBhcmFtMSldIChUT0RPISlcbiAgICBmdW5jdGlvbiBOb2RlQWN0aW9uKG5vZGUsIHJhdykge1xuICAgICAgICAvKlxuICAgICAgICAgaWYgKCFub2RlKVxuICAgICAgICAgY29uc29sZS53YXJuKFwiTm8gbm9kZSBmb3IgTm9kZUFjdGlvblwiKTtcbiAgICAgICAgIGlmICghcmF3KVxuICAgICAgICAgY29uc29sZS53YXJuKFwiTm8gcmF3IGNvbW1hbmRzIGZvciBOb2RlQWN0aW9uXCIpO1xuICAgICAgICAgKi9cblxuICAgICAgICB0aGlzLm5vZGUgPSBub2RlO1xuXG4gICAgICAgIHZhciBzZWN0aW9ucyA9IHJhdy5zcGxpdChcIjpcIik7XG4gICAgICAgIHRoaXMudGFyZ2V0ID0gc2VjdGlvbnNbMF07XG5cbiAgICAgICAgLy8gTm8gY29sb24/IEEgZnVuY3Rpb24hXG4gICAgICAgIGlmIChzZWN0aW9ucy5sZW5ndGggPT09IDEpIHtcbiAgICAgICAgICAgIHRoaXMudHlwZSA9IDI7XG5cbiAgICAgICAgfVxuXG4gICAgICAgIC8vIENvbG9uPyBJdCdzIGVpdGhlciBhIHB1c2ggb3IgYSBwb3BcbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLnJ1bGUgPSBzZWN0aW9uc1sxXTtcbiAgICAgICAgICAgIGlmICh0aGlzLnJ1bGUgPT09IFwiUE9QXCIpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnR5cGUgPSAxO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLnR5cGUgPSAwO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG5cbiAgICBOb2RlQWN0aW9uLnByb3RvdHlwZS5jcmVhdGVVbmRvID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIGlmICh0aGlzLnR5cGUgPT09IDApIHtcbiAgICAgICAgICAgIHJldHVybiBuZXcgTm9kZUFjdGlvbih0aGlzLm5vZGUsIHRoaXMudGFyZ2V0ICsgXCI6UE9QXCIpO1xuICAgICAgICB9XG4gICAgICAgIC8vIFRPRE8gTm90IHN1cmUgaG93IHRvIG1ha2UgVW5kbyBhY3Rpb25zIGZvciBmdW5jdGlvbnMgb3IgUE9Qc1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9O1xuXG4gICAgTm9kZUFjdGlvbi5wcm90b3R5cGUuYWN0aXZhdGUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIGdyYW1tYXIgPSB0aGlzLm5vZGUuZ3JhbW1hcjtcbiAgICAgICAgc3dpdGNoKHRoaXMudHlwZSkge1xuICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAvLyBzcGxpdCBpbnRvIHNlY3Rpb25zICh0aGUgd2F5IHRvIGRlbm90ZSBhbiBhcnJheSBvZiBydWxlcylcbiAgICAgICAgICAgIHRoaXMucnVsZVNlY3Rpb25zID0gdGhpcy5ydWxlLnNwbGl0KFwiLFwiKTtcbiAgICAgICAgICAgIHRoaXMuZmluaXNoZWRSdWxlcyA9IFtdO1xuICAgICAgICAgICAgdGhpcy5ydWxlTm9kZXMgPSBbXTtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5ydWxlU2VjdGlvbnMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICB2YXIgbiA9IG5ldyBUcmFjZXJ5Tm9kZShncmFtbWFyLCAwLCB7XG4gICAgICAgICAgICAgICAgICAgIHR5cGUgOiAtMSxcbiAgICAgICAgICAgICAgICAgICAgcmF3IDogdGhpcy5ydWxlU2VjdGlvbnNbaV1cbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIG4uZXhwYW5kKCk7XG5cbiAgICAgICAgICAgICAgICB0aGlzLmZpbmlzaGVkUnVsZXMucHVzaChuLmZpbmlzaGVkVGV4dCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIFRPRE86IGVzY2FwZSBjb21tYXMgcHJvcGVybHlcbiAgICAgICAgICAgIGdyYW1tYXIucHVzaFJ1bGVzKHRoaXMudGFyZ2V0LCB0aGlzLmZpbmlzaGVkUnVsZXMsIHRoaXMpO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgIGdyYW1tYXIucG9wUnVsZXModGhpcy50YXJnZXQpO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgIGdyYW1tYXIuZmxhdHRlbih0aGlzLnRhcmdldCwgdHJ1ZSk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuXG4gICAgfTtcblxuICAgIE5vZGVBY3Rpb24ucHJvdG90eXBlLnRvVGV4dCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICBzd2l0Y2godGhpcy50eXBlKSB7XG4gICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnRhcmdldCArIFwiOlwiICsgdGhpcy5ydWxlO1xuICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICByZXR1cm4gdGhpcy50YXJnZXQgKyBcIjpQT1BcIjtcbiAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgcmV0dXJuIFwiKChzb21lIGZ1bmN0aW9uKSlcIjtcbiAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgIHJldHVybiBcIigoVW5rbm93biBBY3Rpb24pKVwiO1xuICAgICAgICB9XG4gICAgfTtcblxuICAgIC8vIFNldHMgb2YgcnVsZXNcbiAgICAvLyBDYW4gYWxzbyBjb250YWluIGNvbmRpdGlvbmFsIG9yIGZhbGxiYWNrIHNldHMgb2YgcnVsZXNldHMpXG4gICAgZnVuY3Rpb24gUnVsZVNldChncmFtbWFyLCByYXcpIHtcbiAgICAgICAgdGhpcy5yYXcgPSByYXc7XG4gICAgICAgIHRoaXMuZ3JhbW1hciA9IGdyYW1tYXI7XG4gICAgICAgIHRoaXMuZmFsbG9mZiA9IDE7XG5cbiAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkocmF3KSkge1xuICAgICAgICAgICAgdGhpcy5kZWZhdWx0UnVsZXMgPSByYXc7XG4gICAgICAgIH0gZWxzZSBpZiAoIHR5cGVvZiByYXcgPT09ICdzdHJpbmcnIHx8IHJhdyBpbnN0YW5jZW9mIFN0cmluZykge1xuICAgICAgICAgICAgdGhpcy5kZWZhdWx0UnVsZXMgPSBbcmF3XTtcbiAgICAgICAgfSBlbHNlIGlmIChyYXcgPT09ICdvYmplY3QnKSB7XG4gICAgICAgICAgICAvLyBUT0RPOiBzdXBwb3J0IGZvciBjb25kaXRpb25hbCBhbmQgaGllcmFyY2hpY2FsIHJ1bGUgc2V0c1xuICAgICAgICB9XG5cbiAgICB9O1xuXG4gICAgUnVsZVNldC5wcm90b3R5cGUuc2VsZWN0UnVsZSA9IGZ1bmN0aW9uKGVycm9ycykge1xuICAgICAgICAvLyBjb25zb2xlLmxvZyhcIkdldCBydWxlXCIsIHRoaXMucmF3KTtcbiAgICAgICAgLy8gSXMgdGhlcmUgYSBjb25kaXRpb25hbD9cbiAgICAgICAgaWYgKHRoaXMuY29uZGl0aW9uYWxSdWxlKSB7XG4gICAgICAgICAgICB2YXIgdmFsdWUgPSB0aGlzLmdyYW1tYXIuZXhwYW5kKHRoaXMuY29uZGl0aW9uYWxSdWxlLCB0cnVlKTtcbiAgICAgICAgICAgIC8vIGRvZXMgdGhpcyB2YWx1ZSBtYXRjaCBhbnkgb2YgdGhlIGNvbmRpdGlvbmFscz9cbiAgICAgICAgICAgIGlmICh0aGlzLmNvbmRpdGlvbmFsVmFsdWVzW3ZhbHVlXSkge1xuICAgICAgICAgICAgICAgIHZhciB2ID0gdGhpcy5jb25kaXRpb25hbFZhbHVlc1t2YWx1ZV0uc2VsZWN0UnVsZShlcnJvcnMpO1xuICAgICAgICAgICAgICAgIGlmICh2ICE9PSBudWxsICYmIHYgIT09IHVuZGVmaW5lZClcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHY7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBObyByZXR1cm5lZCB2YWx1ZT9cbiAgICAgICAgfVxuXG4gICAgICAgIC8vIElzIHRoZXJlIGEgcmFua2VkIG9yZGVyP1xuICAgICAgICBpZiAodGhpcy5yYW5raW5nKSB7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMucmFua2luZy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIHZhciB2ID0gdGhpcy5yYW5raW5nLnNlbGVjdFJ1bGUoKTtcbiAgICAgICAgICAgICAgICBpZiAodiAhPT0gbnVsbCAmJiB2ICE9PSB1bmRlZmluZWQpXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB2O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBTdGlsbCBubyByZXR1cm5lZCB2YWx1ZT9cbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh0aGlzLmRlZmF1bHRSdWxlcyAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICB2YXIgaW5kZXggPSAwO1xuICAgICAgICAgICAgLy8gU2VsZWN0IGZyb20gdGhpcyBiYXNpYyBhcnJheSBvZiBydWxlc1xuXG4gICAgICAgICAgICAvLyBHZXQgdGhlIGRpc3RyaWJ1dGlvbiBmcm9tIHRoZSBncmFtbWFyIGlmIHRoZXJlIGlzIG5vIG90aGVyXG4gICAgICAgICAgICB2YXIgZGlzdHJpYnV0aW9uID0gdGhpcy5kaXN0cmlidXRpb247XG4gICAgICAgICAgICBpZiAoIWRpc3RyaWJ1dGlvbilcbiAgICAgICAgICAgICAgICBkaXN0cmlidXRpb24gPSB0aGlzLmdyYW1tYXIuZGlzdHJpYnV0aW9uO1xuXG4gICAgICAgICAgICBzd2l0Y2goZGlzdHJpYnV0aW9uKSB7XG4gICAgICAgICAgICBjYXNlIFwic2h1ZmZsZVwiOlxuXG4gICAgICAgICAgICAgICAgLy8gY3JlYXRlIGEgc2h1ZmZsZSBkZXNrXG4gICAgICAgICAgICAgICAgaWYgKCF0aGlzLnNodWZmbGVkRGVjayB8fCB0aGlzLnNodWZmbGVkRGVjay5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gbWFrZSBhbiBhcnJheVxuICAgICAgICAgICAgICAgICAgICB0aGlzLnNodWZmbGVkRGVjayA9IGZ5c2h1ZmZsZShBcnJheS5hcHBseShudWxsLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICBsZW5ndGggOiB0aGlzLmRlZmF1bHRSdWxlcy5sZW5ndGhcbiAgICAgICAgICAgICAgICAgICAgfSkubWFwKE51bWJlci5jYWxsLCBOdW1iZXIpLCB0aGlzLmZhbGxvZmYpO1xuXG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaW5kZXggPSB0aGlzLnNodWZmbGVkRGVjay5wb3AoKTtcblxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBcIndlaWdodGVkXCI6XG4gICAgICAgICAgICAgICAgZXJyb3JzLnB1c2goXCJXZWlnaHRlZCBkaXN0cmlidXRpb24gbm90IHlldCBpbXBsZW1lbnRlZFwiKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgXCJmYWxsb2ZmXCI6XG4gICAgICAgICAgICAgICAgZXJyb3JzLnB1c2goXCJGYWxsb2ZmIGRpc3RyaWJ1dGlvbiBub3QgeWV0IGltcGxlbWVudGVkXCIpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgZGVmYXVsdDpcblxuICAgICAgICAgICAgICAgIGluZGV4ID0gTWF0aC5mbG9vcihNYXRoLnBvdyhNYXRoLnJhbmRvbSgpLCB0aGlzLmZhbGxvZmYpICogdGhpcy5kZWZhdWx0UnVsZXMubGVuZ3RoKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKCF0aGlzLmRlZmF1bHRVc2VzKVxuICAgICAgICAgICAgICAgIHRoaXMuZGVmYXVsdFVzZXMgPSBbXTtcbiAgICAgICAgICAgIHRoaXMuZGVmYXVsdFVzZXNbaW5kZXhdID0gKyt0aGlzLmRlZmF1bHRVc2VzW2luZGV4XSB8fCAxO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZGVmYXVsdFJ1bGVzW2luZGV4XTtcbiAgICAgICAgfVxuXG4gICAgICAgIGVycm9ycy5wdXNoKFwiTm8gZGVmYXVsdCBydWxlcyBkZWZpbmVkIGZvciBcIiArIHRoaXMpO1xuICAgICAgICByZXR1cm4gbnVsbDtcblxuICAgIH07XG5cbiAgICBSdWxlU2V0LnByb3RvdHlwZS5jbGVhclN0YXRlID0gZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgaWYgKHRoaXMuZGVmYXVsdFVzZXMpIHtcbiAgICAgICAgICAgIHRoaXMuZGVmYXVsdFVzZXMgPSBbXTtcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICBmdW5jdGlvbiBmeXNodWZmbGUoYXJyYXksIGZhbGxvZmYpIHtcbiAgICAgICAgdmFyIGN1cnJlbnRJbmRleCA9IGFycmF5Lmxlbmd0aCxcbiAgICAgICAgICAgIHRlbXBvcmFyeVZhbHVlLFxuICAgICAgICAgICAgcmFuZG9tSW5kZXg7XG5cbiAgICAgICAgLy8gV2hpbGUgdGhlcmUgcmVtYWluIGVsZW1lbnRzIHRvIHNodWZmbGUuLi5cbiAgICAgICAgd2hpbGUgKDAgIT09IGN1cnJlbnRJbmRleCkge1xuXG4gICAgICAgICAgICAvLyBQaWNrIGEgcmVtYWluaW5nIGVsZW1lbnQuLi5cbiAgICAgICAgICAgIHJhbmRvbUluZGV4ID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogY3VycmVudEluZGV4KTtcbiAgICAgICAgICAgIGN1cnJlbnRJbmRleCAtPSAxO1xuXG4gICAgICAgICAgICAvLyBBbmQgc3dhcCBpdCB3aXRoIHRoZSBjdXJyZW50IGVsZW1lbnQuXG4gICAgICAgICAgICB0ZW1wb3JhcnlWYWx1ZSA9IGFycmF5W2N1cnJlbnRJbmRleF07XG4gICAgICAgICAgICBhcnJheVtjdXJyZW50SW5kZXhdID0gYXJyYXlbcmFuZG9tSW5kZXhdO1xuICAgICAgICAgICAgYXJyYXlbcmFuZG9tSW5kZXhdID0gdGVtcG9yYXJ5VmFsdWU7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gYXJyYXk7XG4gICAgfVxuXG4gICAgdmFyIFN5bWJvbCA9IGZ1bmN0aW9uKGdyYW1tYXIsIGtleSwgcmF3UnVsZXMpIHtcbiAgICAgICAgLy8gU3ltYm9scyBjYW4gYmUgbWFkZSB3aXRoIGEgc2luZ2xlIHZhbHVlLCBhbmQgYXJyYXksIG9yIGFycmF5IG9mIG9iamVjdHMgb2YgKGNvbmRpdGlvbnMvdmFsdWVzKVxuICAgICAgICB0aGlzLmtleSA9IGtleTtcbiAgICAgICAgdGhpcy5ncmFtbWFyID0gZ3JhbW1hcjtcbiAgICAgICAgdGhpcy5yYXdSdWxlcyA9IHJhd1J1bGVzO1xuXG4gICAgICAgIHRoaXMuYmFzZVJ1bGVzID0gbmV3IFJ1bGVTZXQodGhpcy5ncmFtbWFyLCByYXdSdWxlcyk7XG4gICAgICAgIHRoaXMuY2xlYXJTdGF0ZSgpO1xuXG4gICAgfTtcblxuICAgIFN5bWJvbC5wcm90b3R5cGUuY2xlYXJTdGF0ZSA9IGZ1bmN0aW9uKCkge1xuXG4gICAgICAgIC8vIENsZWFyIHRoZSBzdGFjayBhbmQgY2xlYXIgYWxsIHJ1bGVzZXQgdXNhZ2VzXG4gICAgICAgIHRoaXMuc3RhY2sgPSBbdGhpcy5iYXNlUnVsZXNdO1xuXG4gICAgICAgIHRoaXMudXNlcyA9IFtdO1xuICAgICAgICB0aGlzLmJhc2VSdWxlcy5jbGVhclN0YXRlKCk7XG4gICAgfTtcblxuICAgIFN5bWJvbC5wcm90b3R5cGUucHVzaFJ1bGVzID0gZnVuY3Rpb24ocmF3UnVsZXMpIHtcbiAgICAgICAgdmFyIHJ1bGVzID0gbmV3IFJ1bGVTZXQodGhpcy5ncmFtbWFyLCByYXdSdWxlcyk7XG4gICAgICAgIHRoaXMuc3RhY2sucHVzaChydWxlcyk7XG4gICAgfTtcblxuICAgIFN5bWJvbC5wcm90b3R5cGUucG9wUnVsZXMgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy5zdGFjay5wb3AoKTtcbiAgICB9O1xuXG4gICAgU3ltYm9sLnByb3RvdHlwZS5zZWxlY3RSdWxlID0gZnVuY3Rpb24obm9kZSwgZXJyb3JzKSB7XG4gICAgICAgIHRoaXMudXNlcy5wdXNoKHtcbiAgICAgICAgICAgIG5vZGUgOiBub2RlXG4gICAgICAgIH0pO1xuXG4gICAgICAgIGlmICh0aGlzLnN0YWNrLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgZXJyb3JzLnB1c2goXCJUaGUgcnVsZSBzdGFjayBmb3IgJ1wiICsgdGhpcy5rZXkgKyBcIicgaXMgZW1wdHksIHRvbyBtYW55IHBvcHM/XCIpO1xuICAgICAgICAgICAgcmV0dXJuIFwiKChcIiArIHRoaXMua2V5ICsgXCIpKVwiO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHRoaXMuc3RhY2tbdGhpcy5zdGFjay5sZW5ndGggLSAxXS5zZWxlY3RSdWxlKCk7XG4gICAgfTtcblxuICAgIFN5bWJvbC5wcm90b3R5cGUuZ2V0QWN0aXZlUnVsZXMgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgaWYgKHRoaXMuc3RhY2subGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5zdGFja1t0aGlzLnN0YWNrLmxlbmd0aCAtIDFdLnNlbGVjdFJ1bGUoKTtcbiAgICB9O1xuXG4gICAgU3ltYm9sLnByb3RvdHlwZS5ydWxlc1RvSlNPTiA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gSlNPTi5zdHJpbmdpZnkodGhpcy5yYXdSdWxlcyk7XG4gICAgfTtcblxuICAgIHZhciBHcmFtbWFyID0gZnVuY3Rpb24ocmF3LCBzZXR0aW5ncykge1xuICAgICAgICB0aGlzLm1vZGlmaWVycyA9IHt9O1xuICAgICAgICB0aGlzLmxvYWRGcm9tUmF3T2JqKHJhdyk7XG4gICAgfTtcblxuICAgIEdyYW1tYXIucHJvdG90eXBlLmNsZWFyU3RhdGUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIGtleXMgPSBPYmplY3Qua2V5cyh0aGlzLnN5bWJvbHMpO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGtleXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHRoaXMuc3ltYm9sc1trZXlzW2ldXS5jbGVhclN0YXRlKCk7XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgR3JhbW1hci5wcm90b3R5cGUuYWRkTW9kaWZpZXJzID0gZnVuY3Rpb24obW9kcykge1xuXG4gICAgICAgIC8vIGNvcHkgb3ZlciB0aGUgYmFzZSBtb2RpZmllcnNcbiAgICAgICAgZm9yICh2YXIga2V5IGluIG1vZHMpIHtcbiAgICAgICAgICAgIGlmIChtb2RzLmhhc093blByb3BlcnR5KGtleSkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLm1vZGlmaWVyc1trZXldID0gbW9kc1trZXldO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuXG4gICAgfTtcblxuICAgIEdyYW1tYXIucHJvdG90eXBlLmxvYWRGcm9tUmF3T2JqID0gZnVuY3Rpb24ocmF3KSB7XG5cbiAgICAgICAgdGhpcy5yYXcgPSByYXc7XG4gICAgICAgIHRoaXMuc3ltYm9scyA9IHt9O1xuICAgICAgICB0aGlzLnN1YmdyYW1tYXJzID0gW107XG5cbiAgICAgICAgaWYgKHRoaXMucmF3KSB7XG4gICAgICAgICAgICAvLyBBZGQgYWxsIHJ1bGVzIHRvIHRoZSBncmFtbWFyXG4gICAgICAgICAgICBmb3IgKHZhciBrZXkgaW4gdGhpcy5yYXcpIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5yYXcuaGFzT3duUHJvcGVydHkoa2V5KSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnN5bWJvbHNba2V5XSA9IG5ldyBTeW1ib2wodGhpcywga2V5LCB0aGlzLnJhd1trZXldKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgR3JhbW1hci5wcm90b3R5cGUuY3JlYXRlUm9vdCA9IGZ1bmN0aW9uKHJ1bGUpIHtcbiAgICAgICAgLy8gQ3JlYXRlIGEgbm9kZSBhbmQgc3Vibm9kZXNcbiAgICAgICAgdmFyIHJvb3QgPSBuZXcgVHJhY2VyeU5vZGUodGhpcywgMCwge1xuICAgICAgICAgICAgdHlwZSA6IC0xLFxuICAgICAgICAgICAgcmF3IDogcnVsZSxcbiAgICAgICAgfSk7XG5cbiAgICAgICAgcmV0dXJuIHJvb3Q7XG4gICAgfTtcblxuICAgIEdyYW1tYXIucHJvdG90eXBlLmV4cGFuZCA9IGZ1bmN0aW9uKHJ1bGUsIGFsbG93RXNjYXBlQ2hhcnMpIHtcbiAgICAgICAgdmFyIHJvb3QgPSB0aGlzLmNyZWF0ZVJvb3QocnVsZSk7XG4gICAgICAgIHJvb3QuZXhwYW5kKCk7XG4gICAgICAgIGlmICghYWxsb3dFc2NhcGVDaGFycylcbiAgICAgICAgICAgIHJvb3QuY2xlYXJFc2NhcGVDaGFycygpO1xuXG4gICAgICAgIHJldHVybiByb290O1xuICAgIH07XG5cbiAgICBHcmFtbWFyLnByb3RvdHlwZS5mbGF0dGVuID0gZnVuY3Rpb24ocnVsZSwgYWxsb3dFc2NhcGVDaGFycykge1xuICAgICAgICB2YXIgcm9vdCA9IHRoaXMuZXhwYW5kKHJ1bGUsIGFsbG93RXNjYXBlQ2hhcnMpO1xuXG4gICAgICAgIHJldHVybiByb290LmZpbmlzaGVkVGV4dDtcbiAgICB9O1xuXG4gICAgR3JhbW1hci5wcm90b3R5cGUudG9KU09OID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBrZXlzID0gT2JqZWN0LmtleXModGhpcy5zeW1ib2xzKTtcbiAgICAgICAgdmFyIHN5bWJvbEpTT04gPSBbXTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBrZXlzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIga2V5ID0ga2V5c1tpXTtcbiAgICAgICAgICAgIHN5bWJvbEpTT04ucHVzaCgnIFwiJyArIGtleSArICdcIiA6ICcgKyB0aGlzLnN5bWJvbHNba2V5XS5ydWxlc1RvSlNPTigpKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gXCJ7XFxuXCIgKyBzeW1ib2xKU09OLmpvaW4oXCIsXFxuXCIpICsgXCJcXG59XCI7XG4gICAgfTtcblxuICAgIC8vIENyZWF0ZSBvciBwdXNoIHJ1bGVzXG4gICAgR3JhbW1hci5wcm90b3R5cGUucHVzaFJ1bGVzID0gZnVuY3Rpb24oa2V5LCByYXdSdWxlcywgc291cmNlQWN0aW9uKSB7XG5cbiAgICAgICAgaWYgKHRoaXMuc3ltYm9sc1trZXldID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHRoaXMuc3ltYm9sc1trZXldID0gbmV3IFN5bWJvbCh0aGlzLCBrZXksIHJhd1J1bGVzKTtcbiAgICAgICAgICAgIGlmIChzb3VyY2VBY3Rpb24pXG4gICAgICAgICAgICAgICAgdGhpcy5zeW1ib2xzW2tleV0uaXNEeW5hbWljID0gdHJ1ZTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuc3ltYm9sc1trZXldLnB1c2hSdWxlcyhyYXdSdWxlcyk7XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgR3JhbW1hci5wcm90b3R5cGUucG9wUnVsZXMgPSBmdW5jdGlvbihrZXkpIHtcbiAgICAgICAgaWYgKCF0aGlzLnN5bWJvbHNba2V5XSlcbiAgICAgICAgICAgIHRoaXMuZXJyb3JzLnB1c2goXCJDYW4ndCBwb3A6IG5vIHN5bWJvbCBmb3Iga2V5IFwiICsga2V5KTtcbiAgICAgICAgdGhpcy5zeW1ib2xzW2tleV0ucG9wUnVsZXMoKTtcbiAgICB9O1xuXG4gICAgR3JhbW1hci5wcm90b3R5cGUuc2VsZWN0UnVsZSA9IGZ1bmN0aW9uKGtleSwgbm9kZSwgZXJyb3JzKSB7XG4gICAgICAgIGlmICh0aGlzLnN5bWJvbHNba2V5XSkge1xuICAgICAgICAgICAgdmFyIHJ1bGUgPSB0aGlzLnN5bWJvbHNba2V5XS5zZWxlY3RSdWxlKG5vZGUsIGVycm9ycyk7XG5cbiAgICAgICAgICAgIHJldHVybiBydWxlO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gRmFpbG92ZXIgdG8gYWx0ZXJuYXRpdmUgc3ViZ3JhbW1hcnNcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLnN1YmdyYW1tYXJzLmxlbmd0aDsgaSsrKSB7XG5cbiAgICAgICAgICAgIGlmICh0aGlzLnN1YmdyYW1tYXJzW2ldLnN5bWJvbHNba2V5XSlcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5zdWJncmFtbWFyc1tpXS5zeW1ib2xzW2tleV0uc2VsZWN0UnVsZSgpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gTm8gc3ltYm9sP1xuICAgICAgICBlcnJvcnMucHVzaChcIk5vIHN5bWJvbCBmb3IgJ1wiICsga2V5ICsgXCInXCIpO1xuICAgICAgICByZXR1cm4gXCIoKFwiICsga2V5ICsgXCIpKVwiO1xuICAgIH07XG5cbiAgICAvLyBQYXJzZXMgYSBwbGFpbnRleHQgcnVsZSBpbiB0aGUgdHJhY2VyeSBzeW50YXhcbiAgICB0cmFjZXJ5ID0ge1xuXG4gICAgICAgIGNyZWF0ZUdyYW1tYXIgOiBmdW5jdGlvbihyYXcpIHtcbiAgICAgICAgICAgIHJldHVybiBuZXcgR3JhbW1hcihyYXcpO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8vIFBhcnNlIHRoZSBjb250ZW50cyBvZiBhIHRhZ1xuICAgICAgICBwYXJzZVRhZyA6IGZ1bmN0aW9uKHRhZ0NvbnRlbnRzKSB7XG5cbiAgICAgICAgICAgIHZhciBwYXJzZWQgPSB7XG4gICAgICAgICAgICAgICAgc3ltYm9sIDogdW5kZWZpbmVkLFxuICAgICAgICAgICAgICAgIHByZWFjdGlvbnMgOiBbXSxcbiAgICAgICAgICAgICAgICBwb3N0YWN0aW9ucyA6IFtdLFxuICAgICAgICAgICAgICAgIG1vZGlmaWVycyA6IFtdXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgdmFyIHNlY3Rpb25zID0gdHJhY2VyeS5wYXJzZSh0YWdDb250ZW50cyk7XG4gICAgICAgICAgICB2YXIgc3ltYm9sU2VjdGlvbiA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2VjdGlvbnMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICBpZiAoc2VjdGlvbnNbaV0udHlwZSA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoc3ltYm9sU2VjdGlvbiA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzeW1ib2xTZWN0aW9uID0gc2VjdGlvbnNbaV0ucmF3O1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgKFwibXVsdGlwbGUgbWFpbiBzZWN0aW9ucyBpbiBcIiArIHRhZ0NvbnRlbnRzKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHBhcnNlZC5wcmVhY3Rpb25zLnB1c2goc2VjdGlvbnNbaV0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKHN5bWJvbFNlY3Rpb24gPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIC8vICAgdGhyb3cgKFwibm8gbWFpbiBzZWN0aW9uIGluIFwiICsgdGFnQ29udGVudHMpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB2YXIgY29tcG9uZW50cyA9IHN5bWJvbFNlY3Rpb24uc3BsaXQoXCIuXCIpO1xuICAgICAgICAgICAgICAgIHBhcnNlZC5zeW1ib2wgPSBjb21wb25lbnRzWzBdO1xuICAgICAgICAgICAgICAgIHBhcnNlZC5tb2RpZmllcnMgPSBjb21wb25lbnRzLnNsaWNlKDEpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHBhcnNlZDtcbiAgICAgICAgfSxcblxuICAgICAgICBwYXJzZSA6IGZ1bmN0aW9uKHJ1bGUpIHtcbiAgICAgICAgICAgIHZhciBkZXB0aCA9IDA7XG4gICAgICAgICAgICB2YXIgaW5UYWcgPSBmYWxzZTtcbiAgICAgICAgICAgIHZhciBzZWN0aW9ucyA9IFtdO1xuICAgICAgICAgICAgdmFyIGVzY2FwZWQgPSBmYWxzZTtcblxuICAgICAgICAgICAgdmFyIGVycm9ycyA9IFtdO1xuICAgICAgICAgICAgdmFyIHN0YXJ0ID0gMDtcblxuICAgICAgICAgICAgdmFyIGVzY2FwZWRTdWJzdHJpbmcgPSBcIlwiO1xuICAgICAgICAgICAgdmFyIGxhc3RFc2NhcGVkQ2hhciA9IHVuZGVmaW5lZDtcblxuICAgICAgICAgICAgaWYgKHJ1bGUgPT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICB2YXIgc2VjdGlvbnMgPSBbXTtcbiAgICAgICAgICAgICAgICBzZWN0aW9ucy5lcnJvcnMgPSBlcnJvcnM7XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gc2VjdGlvbnM7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIGNyZWF0ZVNlY3Rpb24oc3RhcnQsIGVuZCwgdHlwZSkge1xuICAgICAgICAgICAgICAgIGlmIChlbmQgLSBzdGFydCA8IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGUgPT09IDEpXG4gICAgICAgICAgICAgICAgICAgICAgICBlcnJvcnMucHVzaChzdGFydCArIFwiOiBlbXB0eSB0YWdcIik7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0eXBlID09PSAyKVxuICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3JzLnB1c2goc3RhcnQgKyBcIjogZW1wdHkgYWN0aW9uXCIpO1xuXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciByYXdTdWJzdHJpbmc7XG4gICAgICAgICAgICAgICAgaWYgKGxhc3RFc2NhcGVkQ2hhciAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJhd1N1YnN0cmluZyA9IGVzY2FwZWRTdWJzdHJpbmcgKyBcIlxcXFxcIiArIHJ1bGUuc3Vic3RyaW5nKGxhc3RFc2NhcGVkQ2hhciArIDEsIGVuZCk7XG5cbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICByYXdTdWJzdHJpbmcgPSBydWxlLnN1YnN0cmluZyhzdGFydCwgZW5kKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgc2VjdGlvbnMucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgIHR5cGUgOiB0eXBlLFxuICAgICAgICAgICAgICAgICAgICByYXcgOiByYXdTdWJzdHJpbmdcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBsYXN0RXNjYXBlZENoYXIgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICAgICAgZXNjYXBlZFN1YnN0cmluZyA9IFwiXCI7XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHJ1bGUubGVuZ3RoOyBpKyspIHtcblxuICAgICAgICAgICAgICAgIGlmICghZXNjYXBlZCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgYyA9IHJ1bGUuY2hhckF0KGkpO1xuXG4gICAgICAgICAgICAgICAgICAgIHN3aXRjaChjKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gRW50ZXIgYSBkZWVwZXIgYnJhY2tldGVkIHNlY3Rpb25cbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnWyc6XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZGVwdGggPT09IDAgJiYgIWluVGFnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHN0YXJ0IDwgaSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY3JlYXRlU2VjdGlvbihzdGFydCwgaSwgMCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhcnQgPSBpICsgMTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGRlcHRoKys7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgICAgICBjYXNlICddJzpcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlcHRoLS07XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEVuZCBhIGJyYWNrZXRlZCBzZWN0aW9uXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZGVwdGggPT09IDAgJiYgIWluVGFnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY3JlYXRlU2VjdGlvbihzdGFydCwgaSwgMik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhcnQgPSBpICsgMTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIEhhc2h0YWdcbiAgICAgICAgICAgICAgICAgICAgLy8gICBpZ25vcmUgaWYgbm90IGF0IGRlcHRoIDAsIHRoYXQgbWVhbnMgd2UgYXJlIGluIGEgYnJhY2tldFxuICAgICAgICAgICAgICAgICAgICBjYXNlICcjJzpcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkZXB0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpblRhZykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjcmVhdGVTZWN0aW9uKHN0YXJ0LCBpLCAxKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhcnQgPSBpICsgMTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoc3RhcnQgPCBpKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY3JlYXRlU2VjdGlvbihzdGFydCwgaSwgMCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXJ0ID0gaSArIDE7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluVGFnID0gIWluVGFnO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnXFxcXCc6XG4gICAgICAgICAgICAgICAgICAgICAgICBlc2NhcGVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGVzY2FwZWRTdWJzdHJpbmcgPSBlc2NhcGVkU3Vic3RyaW5nICsgcnVsZS5zdWJzdHJpbmcoc3RhcnQsIGkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgc3RhcnQgPSBpICsgMTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxhc3RFc2NhcGVkQ2hhciA9IGk7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGVzY2FwZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoc3RhcnQgPCBydWxlLmxlbmd0aClcbiAgICAgICAgICAgICAgICBjcmVhdGVTZWN0aW9uKHN0YXJ0LCBydWxlLmxlbmd0aCwgMCk7XG5cbiAgICAgICAgICAgIGlmIChpblRhZykge1xuICAgICAgICAgICAgICAgIGVycm9ycy5wdXNoKFwiVW5jbG9zZWQgdGFnXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGRlcHRoID4gMCkge1xuICAgICAgICAgICAgICAgIGVycm9ycy5wdXNoKFwiVG9vIG1hbnkgW1wiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChkZXB0aCA8IDApIHtcbiAgICAgICAgICAgICAgICBlcnJvcnMucHVzaChcIlRvbyBtYW55IF1cIik7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIFN0cmlwIG91dCBlbXB0eSBwbGFpbnRleHQgc2VjdGlvbnNcblxuICAgICAgICAgICAgc2VjdGlvbnMgPSBzZWN0aW9ucy5maWx0ZXIoZnVuY3Rpb24oc2VjdGlvbikge1xuICAgICAgICAgICAgICAgIGlmIChzZWN0aW9uLnR5cGUgPT09IDAgJiYgc2VjdGlvbi5yYXcubGVuZ3RoID09PSAwKVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHNlY3Rpb25zLmVycm9ycyA9IGVycm9ycztcbiAgICAgICAgICAgIHJldHVybiBzZWN0aW9ucztcbiAgICAgICAgfSxcbiAgICB9O1xuXG4gICAgZnVuY3Rpb24gaXNWb3dlbChjKSB7XG4gICAgICAgIHZhciBjMiA9IGMudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgcmV0dXJuIChjMiA9PT0gJ2EnKSB8fCAoYzIgPT09ICdlJykgfHwgKGMyID09PSAnaScpIHx8IChjMiA9PT0gJ28nKSB8fCAoYzIgPT09ICd1Jyk7XG4gICAgfTtcblxuICAgIGZ1bmN0aW9uIGlzQWxwaGFOdW0oYykge1xuICAgICAgICByZXR1cm4gKGMgPj0gJ2EnICYmIGMgPD0gJ3onKSB8fCAoYyA+PSAnQScgJiYgYyA8PSAnWicpIHx8IChjID49ICcwJyAmJiBjIDw9ICc5Jyk7XG4gICAgfTtcbiAgICBmdW5jdGlvbiBlc2NhcGVSZWdFeHAoc3RyKSB7XG4gICAgICAgIHJldHVybiBzdHIucmVwbGFjZSgvKFsuKis/Xj0hOiR7fSgpfFxcW1xcXVxcL1xcXFxdKS9nLCBcIlxcXFwkMVwiKTtcbiAgICB9XG5cbiAgICB2YXIgYmFzZUVuZ01vZGlmaWVycyA9IHtcblxuICAgICAgICByZXBsYWNlIDogZnVuY3Rpb24ocywgcGFyYW1zKSB7XG4gICAgICAgICAgICAvL2h0dHA6Ly9zdGFja292ZXJmbG93LmNvbS9xdWVzdGlvbnMvMTE0NDc4My9yZXBsYWNpbmctYWxsLW9jY3VycmVuY2VzLW9mLWEtc3RyaW5nLWluLWphdmFzY3JpcHRcbiAgICAgICAgICAgIHJldHVybiBzLnJlcGxhY2UobmV3IFJlZ0V4cChlc2NhcGVSZWdFeHAocGFyYW1zWzBdKSwgJ2cnKSwgcGFyYW1zWzFdKTtcbiAgICAgICAgfSxcblxuICAgICAgICBjYXBpdGFsaXplQWxsIDogZnVuY3Rpb24ocykge1xuICAgICAgICAgICAgdmFyIHMyID0gXCJcIjtcbiAgICAgICAgICAgIHZhciBjYXBOZXh0ID0gdHJ1ZTtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcy5sZW5ndGg7IGkrKykge1xuXG4gICAgICAgICAgICAgICAgaWYgKCFpc0FscGhhTnVtKHMuY2hhckF0KGkpKSkge1xuICAgICAgICAgICAgICAgICAgICBjYXBOZXh0ID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgczIgKz0gcy5jaGFyQXQoaSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFjYXBOZXh0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzMiArPSBzLmNoYXJBdChpKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHMyICs9IHMuY2hhckF0KGkpLnRvVXBwZXJDYXNlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXBOZXh0ID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBzMjtcbiAgICAgICAgfSxcblxuICAgICAgICBjYXBpdGFsaXplIDogZnVuY3Rpb24ocykge1xuICAgICAgICAgICAgcmV0dXJuIHMuY2hhckF0KDApLnRvVXBwZXJDYXNlKCkgKyBzLnN1YnN0cmluZygxKTtcbiAgICAgICAgfSxcblxuICAgICAgICBhIDogZnVuY3Rpb24ocykge1xuICAgICAgICAgICAgaWYgKHMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIGlmIChzLmNoYXJBdCgwKS50b0xvd2VyQ2FzZSgpID09PSAndScpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHMubGVuZ3RoID4gMikge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHMuY2hhckF0KDIpLnRvTG93ZXJDYXNlKCkgPT09ICdpJylcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gXCJhIFwiICsgcztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmIChpc1Zvd2VsKHMuY2hhckF0KDApKSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gXCJhbiBcIiArIHM7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gXCJhIFwiICsgcztcblxuICAgICAgICB9LFxuXG4gICAgICAgIGZpcnN0UyA6IGZ1bmN0aW9uKHMpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKHMpO1xuICAgICAgICAgICAgdmFyIHMyID0gcy5zcGxpdChcIiBcIik7XG5cbiAgICAgICAgICAgIHZhciBmaW5pc2hlZCA9IGJhc2VFbmdNb2RpZmllcnMucyhzMlswXSkgKyBcIiBcIiArIHMyLnNsaWNlKDEpLmpvaW4oXCIgXCIpO1xuICAgICAgICAgICAgY29uc29sZS5sb2coZmluaXNoZWQpO1xuICAgICAgICAgICAgcmV0dXJuIGZpbmlzaGVkO1xuICAgICAgICB9LFxuXG4gICAgICAgIHMgOiBmdW5jdGlvbihzKSB7XG4gICAgICAgICAgICBzd2l0Y2ggKHMuY2hhckF0KHMubGVuZ3RoIC0xKSkge1xuICAgICAgICAgICAgY2FzZSAncyc6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHMgKyBcImVzXCI7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlICdoJzpcbiAgICAgICAgICAgICAgICByZXR1cm4gcyArIFwiZXNcIjtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgJ3gnOlxuICAgICAgICAgICAgICAgIHJldHVybiBzICsgXCJlc1wiO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAneSc6XG4gICAgICAgICAgICAgICAgaWYgKCFpc1Zvd2VsKHMuY2hhckF0KHMubGVuZ3RoIC0gMikpKVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcy5zdWJzdHJpbmcoMCwgcy5sZW5ndGggLSAxKSArIFwiaWVzXCI7XG4gICAgICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcyArIFwic1wiO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gcyArIFwic1wiO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBlZCA6IGZ1bmN0aW9uKHMpIHtcbiAgICAgICAgICAgIHN3aXRjaCAocy5jaGFyQXQocy5sZW5ndGggLTEpKSB7XG4gICAgICAgICAgICBjYXNlICdzJzpcbiAgICAgICAgICAgICAgICByZXR1cm4gcyArIFwiZWRcIjtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgJ2UnOlxuICAgICAgICAgICAgICAgIHJldHVybiBzICsgXCJkXCI7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlICdoJzpcbiAgICAgICAgICAgICAgICByZXR1cm4gcyArIFwiZWRcIjtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgJ3gnOlxuICAgICAgICAgICAgICAgIHJldHVybiBzICsgXCJlZFwiO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAneSc6XG4gICAgICAgICAgICAgICAgaWYgKCFpc1Zvd2VsKHMuY2hhckF0KHMubGVuZ3RoIC0gMikpKVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcy5zdWJzdHJpbmcoMCwgcy5sZW5ndGggLSAxKSArIFwiaWVkXCI7XG4gICAgICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcyArIFwiZFwiO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gcyArIFwiZWRcIjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG5cbiAgICB0cmFjZXJ5LmJhc2VFbmdNb2RpZmllcnMgPSBiYXNlRW5nTW9kaWZpZXJzOyBcbiAgICAvLyBFeHRlcm5hbGl6ZVxuICAgIHRyYWNlcnkuVHJhY2VyeU5vZGUgPSBUcmFjZXJ5Tm9kZTtcblxuICAgIHRyYWNlcnkuR3JhbW1hciA9IEdyYW1tYXI7XG4gICAgdHJhY2VyeS5TeW1ib2wgPSBTeW1ib2w7XG4gICAgdHJhY2VyeS5SdWxlU2V0ID0gUnVsZVNldDtcbiAgICByZXR1cm4gdHJhY2VyeTtcbn0oKTtcblxubW9kdWxlLmV4cG9ydHMgPSB0cmFjZXJ5OyAiLCIvLyBUaGUgbW9kdWxlIGNhY2hlXG52YXIgX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fID0ge307XG5cbi8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG5mdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuXHR2YXIgY2FjaGVkTW9kdWxlID0gX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fW21vZHVsZUlkXTtcblx0aWYgKGNhY2hlZE1vZHVsZSAhPT0gdW5kZWZpbmVkKSB7XG5cdFx0cmV0dXJuIGNhY2hlZE1vZHVsZS5leHBvcnRzO1xuXHR9XG5cdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG5cdHZhciBtb2R1bGUgPSBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdID0ge1xuXHRcdC8vIG5vIG1vZHVsZS5pZCBuZWVkZWRcblx0XHQvLyBubyBtb2R1bGUubG9hZGVkIG5lZWRlZFxuXHRcdGV4cG9ydHM6IHt9XG5cdH07XG5cblx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG5cdF9fd2VicGFja19tb2R1bGVzX19bbW9kdWxlSWRdKG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG5cdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG5cdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbn1cblxuIiwiXCJ1c2Ugc3RyaWN0XCI7XHJcbihmdW5jdGlvbiAoKSB7XHJcbiAgICAndXNlIHN0cmljdCc7XHJcbiAgICBsZXQgdHJhY2VyeSA9IHJlcXVpcmUoJ3RyYWNlcnktZ3JhbW1hcicpO1xyXG4gICAgbGV0IGdyYW1tYXIgPSB0cmFjZXJ5LmNyZWF0ZUdyYW1tYXIoSlNPTi5wYXJzZShHTV9nZXRSZXNvdXJjZVRleHQoXCJjSlNPTlwiKSkpO1xyXG4gICAgZ3JhbW1hci5hZGRNb2RpZmllcnModHJhY2VyeS5iYXNlRW5nTW9kaWZpZXJzKTtcclxuICAgIGNvbnN0IERST1BET1dOX0hUTUwgPSBgXHJcbiAgICA8cCBjbGFzcz1cImZvb3Rub3RlXCIgc3R5bGU9XCJtYXJnaW4tYm90dG9tOiAtMTVweDtcIj5cclxuICAgICAgICA8c2VsZWN0IG5hbWU9XCJuaWNlLWNvbW1lbnRcIiBpZD1cIm5pY2UtY29tbWVudC1kcm9wZG93blwiPlxyXG4gICAgICAgICAgICA8b3B0aW9uIHNlbGVjdGVkPVwic2VsZWN0ZWRcIiB2YWx1ZT1cImNsZWFyXCI+PC9vcHRpb24+XHJcbiAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9XCJyZV9yZWFkXCI+UmUtcmVhZDwvb3B0aW9uPlxyXG4gICAgICAgICAgICA8b3B0aW9uIHZhbHVlPVwibG92ZVwiPkxvdmU8L29wdGlvbj5cclxuICAgICAgICA8L3NlbGVjdD5cclxuICAgIDwvcD5cclxuICAgIGA7XHJcbiAgICBsZXQgZHJvcGRvd25XcmFwID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgncCcpO1xyXG4gICAgZHJvcGRvd25XcmFwLmlubmVySFRNTCA9IERST1BET1dOX0hUTUw7XHJcbiAgICBkcm9wZG93bldyYXAgPSBkcm9wZG93bldyYXAuZmlyc3RFbGVtZW50Q2hpbGQ7XHJcbiAgICBsZXQgZHJvcGRvd24gPSBkcm9wZG93bldyYXAuZmlyc3RFbGVtZW50Q2hpbGQ7XHJcbiAgICBjb25zdCBDT01NRU5UX0lOUFVUID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcInRleHRhcmVhW2lkKj0nY29tbWVudF9jb250ZW50X2ZvciddXCIpO1xyXG4gICAgZHJvcGRvd24uYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgKCkgPT4gQ09NTUVOVF9JTlBVVC52YWx1ZSA9IGdyYW1tYXIuZmxhdHRlbihgIyR7ZHJvcGRvd24udmFsdWV9I2ApLnJlcGxhY2UoXCIgIFwiLCBcIiBcIikpO1xyXG4gICAgbGV0IGNvbW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiZm9ybS5uZXdfY29tbWVudCBmaWVsZHNldFwiKTtcclxuICAgIGNvbW1lbnQuaW5zZXJ0QmVmb3JlKGRyb3Bkb3duV3JhcCwgY29tbWVudC5jaGlsZHJlblszXSk7XHJcbn0pKCk7XHJcbiJdLCJuYW1lcyI6WyJ0cmFjZXJ5IiwiVHJhY2VyeU5vZGUiLCJwYXJlbnQiLCJjaGlsZEluZGV4Iiwic2V0dGluZ3MiLCJ0aGlzIiwiZXJyb3JzIiwidW5kZWZpbmVkIiwicmF3IiwicHVzaCIsIkdyYW1tYXIiLCJncmFtbWFyIiwiZGVwdGgiLCJ0eXBlIiwiaXNFeHBhbmRlZCIsIk5vZGVBY3Rpb24iLCJub2RlIiwic2VjdGlvbnMiLCJzcGxpdCIsInRhcmdldCIsImxlbmd0aCIsInJ1bGUiLCJSdWxlU2V0IiwiZmFsbG9mZiIsIkFycmF5IiwiaXNBcnJheSIsImRlZmF1bHRSdWxlcyIsIlN0cmluZyIsInByb3RvdHlwZSIsInRvU3RyaW5nIiwiZXhwYW5kQ2hpbGRyZW4iLCJjaGlsZFJ1bGUiLCJwcmV2ZW50UmVjdXJzaW9uIiwiY2hpbGRyZW4iLCJmaW5pc2hlZFRleHQiLCJwYXJzZSIsImNvbmNhdCIsImkiLCJleHBhbmQiLCJleHBhbnNpb25FcnJvcnMiLCJwcmVhY3Rpb25zIiwicG9zdGFjdGlvbnMiLCJwYXJzZWQiLCJwYXJzZVRhZyIsInN5bWJvbCIsIm1vZGlmaWVycyIsImNyZWF0ZVVuZG8iLCJhY3RpdmF0ZSIsInNlbGVjdGVkUnVsZSIsInNlbGVjdFJ1bGUiLCJtb2ROYW1lIiwibW9kUGFyYW1zIiwiaW5kZXhPZiIsInJlc3VsdHMiLCJleGVjIiwic3Vic3RyaW5nIiwibW9kIiwiYWN0aW9uIiwiY2xlYXJFc2NhcGVDaGFycyIsInJlcGxhY2UiLCJydWxlU2VjdGlvbnMiLCJmaW5pc2hlZFJ1bGVzIiwicnVsZU5vZGVzIiwibiIsInB1c2hSdWxlcyIsInBvcFJ1bGVzIiwiZmxhdHRlbiIsInRvVGV4dCIsImNvbmRpdGlvbmFsUnVsZSIsInZhbHVlIiwiY29uZGl0aW9uYWxWYWx1ZXMiLCJ2IiwicmFua2luZyIsImluZGV4IiwiZGlzdHJpYnV0aW9uIiwic2h1ZmZsZWREZWNrIiwiYXJyYXkiLCJ0ZW1wb3JhcnlWYWx1ZSIsInJhbmRvbUluZGV4IiwiY3VycmVudEluZGV4IiwiTWF0aCIsImZsb29yIiwicmFuZG9tIiwiZnlzaHVmZmxlIiwiYXBwbHkiLCJtYXAiLCJOdW1iZXIiLCJjYWxsIiwicG9wIiwicG93IiwiZGVmYXVsdFVzZXMiLCJjbGVhclN0YXRlIiwiU3ltYm9sIiwia2V5IiwicmF3UnVsZXMiLCJiYXNlUnVsZXMiLCJzdGFjayIsInVzZXMiLCJydWxlcyIsImdldEFjdGl2ZVJ1bGVzIiwicnVsZXNUb0pTT04iLCJKU09OIiwic3RyaW5naWZ5IiwibG9hZEZyb21SYXdPYmoiLCJpc1Zvd2VsIiwiYyIsImMyIiwidG9Mb3dlckNhc2UiLCJrZXlzIiwiT2JqZWN0Iiwic3ltYm9scyIsImFkZE1vZGlmaWVycyIsIm1vZHMiLCJoYXNPd25Qcm9wZXJ0eSIsInN1YmdyYW1tYXJzIiwiY3JlYXRlUm9vdCIsImFsbG93RXNjYXBlQ2hhcnMiLCJyb290IiwidG9KU09OIiwic3ltYm9sSlNPTiIsImpvaW4iLCJzb3VyY2VBY3Rpb24iLCJpc0R5bmFtaWMiLCJiYXNlRW5nTW9kaWZpZXJzIiwicyIsInBhcmFtcyIsIlJlZ0V4cCIsImNhcGl0YWxpemVBbGwiLCJzMiIsImNhcE5leHQiLCJjaGFyQXQiLCJ0b1VwcGVyQ2FzZSIsImNhcGl0YWxpemUiLCJhIiwiZmlyc3RTIiwiY29uc29sZSIsImxvZyIsImZpbmlzaGVkIiwic2xpY2UiLCJlZCIsImNyZWF0ZUdyYW1tYXIiLCJ0YWdDb250ZW50cyIsInN5bWJvbFNlY3Rpb24iLCJjb21wb25lbnRzIiwiaW5UYWciLCJlc2NhcGVkIiwic3RhcnQiLCJlc2NhcGVkU3Vic3RyaW5nIiwibGFzdEVzY2FwZWRDaGFyIiwiY3JlYXRlU2VjdGlvbiIsImVuZCIsInJhd1N1YnN0cmluZyIsImZpbHRlciIsInNlY3Rpb24iLCJtb2R1bGUiLCJleHBvcnRzIiwiX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fIiwiX193ZWJwYWNrX3JlcXVpcmVfXyIsIm1vZHVsZUlkIiwiY2FjaGVkTW9kdWxlIiwiX193ZWJwYWNrX21vZHVsZXNfXyIsIkdNX2dldFJlc291cmNlVGV4dCIsImRyb3Bkb3duV3JhcCIsImRvY3VtZW50IiwiY3JlYXRlRWxlbWVudCIsImlubmVySFRNTCIsImZpcnN0RWxlbWVudENoaWxkIiwiZHJvcGRvd24iLCJDT01NRU5UX0lOUFVUIiwicXVlcnlTZWxlY3RvciIsImFkZEV2ZW50TGlzdGVuZXIiLCJjb21tZW50IiwiaW5zZXJ0QmVmb3JlIl0sInNvdXJjZVJvb3QiOiIifQ==